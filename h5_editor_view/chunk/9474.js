"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[9474],{"9474":function(o,l,r){r.r(l),r.d(l,{"default":function(){return g}});var u=r(4864),a=r(1760),c=r(3464),d="index-module__input-text-box___0wFhz",h="index-module__tool-box___izvOD",m="index-module__tool-header___j2Df9",v="index-module__emoji-btn___t0QJ9",f=r(2922);var p=function EmojiViewer(o){var l=o.className,r=o.onEmojiClick,u=o.emojiList,d=(0,c.useState)("normal"),h=(0,a.Z)(d,2),m=h[0],v=h[1];return(0,f.jsxs)("div",{"className":"emoji-content-box ".concat(l),"children":[(0,f.jsx)("div",{"className":"menu-list","children":u.map((function(o,l){var r=o.type,u=o.identity,a=o.url;return(0,f.jsx)("div",{"className":m==u?"menu-item menu-item-hover":"menu-item","onClick":function onClick(){!function changeSelectType(o){var l=o.identity;m!==l&&v(l)}(o)},"children":"img"===r?(0,f.jsx)("img",{"className":"menu-item-img","src":a,"alt":u}):a},l)}))}),(0,f.jsx)("div",{"className":"emoji-list-box","children":u.map((function(o,l){var u=o.icons,a=o.identity,c=o.type;return(0,f.jsx)("div",{"className":a==m?"emoji-classify-item classify-selected":"emoji-classify-item","id":c,"children":u.map((function(o,l){var u=o.url;return(0,f.jsx)("div",{"className":"select-item","onClick":function onClick(){!function emojiClickHandle(o){r&&r(o)}(o)},"children":"img"===c?(0,f.jsx)("img",{"className":"select-item-img","src":u}):u},l)}))},l)}))})]})},y=[{"identity":"normal","type":"emoji","url":"😀","icons":[{"type":"emoji","url":"😀","iconName":"努力","text":"努力哦~"},{"type":"emoji","url":"😄","iconName":"惊讶","text":"惊讶~"},{"type":"emoji","url":"🙃","iconName":"开心","text":"开心的一天"},{"type":"emoji","url":"😅","iconName":"哭笑","text":"哭笑"},{"type":"emoji","url":"🤣","iconName":"难过","text":"有点难过"},{"type":"emoji","url":"😍","iconName":"生气","text":"生气了"},{"type":"emoji","url":"😁","iconName":"躺平","text":"躺平"},{"type":"emoji","url":"😆","iconName":"喜欢","text":"好喜欢~"}]},{"identity":"unnormal","type":"emoji","url":"😍","icons":[{"type":"url","url":"😁","iconName":"喜欢","text":"好喜欢~"}]}],x=r(6830),k=r(8652),E=function t(){},j=function(){function e(o){var l,r=this;(0,x.Z)(this,e),this.beforeInputHandle=function(o){var l=o.data||"";return r.autoInput&&r.cursorHandle.insertText(l),r.onKeyBoardInput(l),o.preventDefault(),!1},this.el=o.el,this.cursorHandle=new b(o.el),this.changeCallBack=o.onChange||E,this.onKeyBoardInput=o.onInput||E,this.autoInput=null===(l=o.autoInput)||void 0===l||l,this.init(),this.enableKeyBoardModel(o.enableKeyBoard)}return(0,k.Z)(e,[{"key":"initTextClickFn","value":function initTextClickFn(o){var l,r=o.target;if(r)if(null===(l=this.el)||void 0===l?void 0:l.isSameNode(r))this.cursorHandle.mounted(!0);else{!function i(o,l){var r=l.parentNode;r&&(r.lastChild==l?r.appendChild(o):r.insertBefore(o,l.nextSibling))}(this.cursorHandle.cursorEl,r.previousSibling||r)}}},{"key":"keyupFn","value":function keyupFn(o){"Backspace"===o.key&&this.cursorHandle.delEl()}},{"key":"init","value":function init(){this.el&&(this.el.addEventListener("beforeinput",this.beforeInputHandle.bind(this)),this.el.addEventListener("keyup",this.keyupFn.bind(this)),this.el.addEventListener("click",this.initTextClickFn.bind(this)),this.initStatu="ok")}},{"key":"enableKeyBoardModel","value":function enableKeyBoardModel(){var o,l=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.enableKeyBoard!==l&&(this.enableKeyBoard=l,null===(o=this.el)||void 0===o||o.setAttribute("contentEditable","".concat(l)))}},{"key":"showCursor","value":function showCursor(){this.cursorHandle.mounted()}},{"key":"focus","value":function focus(){this.cursorHandle.focus()}},{"key":"insertText","value":function insertText(o){this.cursorHandle.insertText(o),this.changeCallBack()}},{"key":"insertEl","value":function insertEl(o){this.cursorHandle.insertEl(o)}},{"key":"getTextContetn","value":function getTextContetn(){var o;return(null===(o=this.el)||void 0===o?void 0:o.textContent)||""}},{"key":"destroy","value":function destroy(){var o,l;null===(o=this.el)||void 0===o||o.removeEventListener("beforeinput",this.beforeInputHandle),null===(l=this.el)||void 0===l||l.removeEventListener("click",this.initTextClickFn)}}]),e}(),b=function(){function n(o){(0,x.Z)(this,n),this.cursorEl=this.createCursor(),this.pollyfil=this.createPollyfil(),this.containerEl=o}return(0,k.Z)(n,[{"key":"createPollyfil","value":function createPollyfil(){var o=document.createElement("span");return o.style.display="inline-block",o.style.height="1em",o}},{"key":"mountePollyfil","value":function mountePollyfil(){var o;this.isMount&&(null===(o=this.cursorEl.parentNode)||void 0===o||o.insertBefore(this.pollyfil,this.cursorEl))}},{"key":"createCursor","value":function createCursor(){!function(){var o="editor-box-cursor-css";if(!(document.querySelectorAll("#".concat(o)).length>0)){var l=document.createElement("style");l.id=o,l.textContent="\n  @keyframes cursor-blinks {\n    0% {\n      opacity: 1;\n      display: block;\n    }\n    50% {\n      opacity: 0;\n      display: none;\n    }\n    100% {\n      opacity: 1;\n      display: block;\n    }\n  }\n  .cursor {\n    width: 0;\n    overflow: visible;\n    position: relative;\n    pointer-events: none;\n  }\n  .cursor .line {\n    display: inline-block;\n    position: absolute;\n    pointer-events: none;\n    width: 0.1em;\n    height: 100%;\n    min-height: 1em;\n    background: #000;\n    left: 0;\n    top: 50%;\n    transform: translate(0, -50%);\n    animation: cursor-blinks 1.5s infinite steps(1, start);\n  }\n  ",document.head.appendChild(l)}}();var o=document.createElement("span");o.className="cursor";var l=document.createElement("span");return l.className="line",o.appendChild(l),o.contentEditable="false",o}},{"key":"getCursor","value":function getCursor(){return this.cursorEl}},{"key":"mounted","value":function mounted(){var o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.containerEl&&(this.isMount&&!o||this.containerEl.appendChild(this.cursorEl),this.isMount=!0,(this.containerEl.children||[]).length<2&&this.mountePollyfil())}},{"key":"unmounted","value":function unmounted(){var o;null===(o=this.cursorEl.parentNode)||void 0===o||o.removeChild(this.cursorEl),this.isMount=!1}},{"key":"focus","value":function focus(){var o;this.isMount?null===(o=this.cursorEl.parentElement)||void 0===o||o.focus():this.containerEl&&(this.mounted(),this.containerEl.focus())}},{"key":"insertText","value":function insertText(o,l){if(!l){if(!this.isMount)return;l=this.cursorEl}this.insertEl(function s(o){var l=document.createDocumentFragment();return o.split("").map((function(o){var r=document.createElement("span");r.textContent=o,r.className="txt",l.appendChild(r)})),l}(o),l)}},{"key":"insertEl","value":function insertEl(o,l){var r;if(!l){if(!this.isMount)return;l=this.cursorEl}null===(r=l.parentNode)||void 0===r||r.insertBefore(o,l)}},{"key":"delEl","value":function delEl(){var o,l=this.cursorEl,r=l.previousElementSibling;r&&(null===(o=l.parentNode)||void 0===o||o.removeChild(r))}}]),n}();var C=function EditorDemo(){var o=(0,c.useState)(!1),l=(0,a.Z)(o,2),r=l[0],u=l[1],x=(0,c.useState)(!1),k=(0,a.Z)(x,2),E=k[0],b=k[1],C=(0,c.useRef)(null),g=(0,c.useRef)();(0,c.useEffect)((function(){if(C.current)return g.current=new j({"el":C.current,"enableKeyBoard":!0,"autoInput":!0,"onChange":function onChange(){},"onInput":function onInput(o){N(o)}}),function(){var o;null===(o=g.current)||void 0===o||o.destroy()}}),[]);var N=function textareaChangeHandle(o){console.log("has change",o)};return(0,f.jsxs)("div",{"children":[(0,f.jsx)("div",{"children":(0,f.jsx)("div",{"ref":C,"onFocus":function showToolBarHandle(){u(!0)},"className":d})}),(0,f.jsxs)("div",{"className":h,"children":[r&&(0,f.jsxs)("div",{"className":m,"children":[(0,f.jsx)("div",{"className":v,"children":E?(0,f.jsx)("span",{"onClick":function hidenEmojiHandle(){var o,l;null===(o=g.current)||void 0===o||o.enableKeyBoardModel(),null===(l=g.current)||void 0===l||l.focus(),b(!1)},"children":"打开键盘"}):(0,f.jsx)("span",{"onClick":function showEmojiHandle(){var o,l;b(!0),null===(o=g.current)||void 0===o||o.enableKeyBoardModel(!1),null===(l=g.current)||void 0===l||l.showCursor()},"children":"打开表情"})}),(0,f.jsx)("div",{"children":(0,f.jsx)("span",{"children":"工具2"})})]}),E&&(0,f.jsx)(p,{"emojiList":y,"onEmojiClick":function insetTextHandle(o){var l,r=o.iconName;null===(l=g.current)||void 0===l||l.insertText("[".concat(r,"]"))}})]})]})},g=function fn(){return(0,f.jsx)(u.G7,{"style":{"marginTop":"50px","backgroundColor":"#ccc"},"children":(0,f.jsx)(C,{})})}}}]);